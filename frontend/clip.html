<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Clip Video - Universal Video Downloader & Editor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
    body {
      font-family: 'Inter', sans-serif;
      background: radial-gradient(circle at top left, #0f0f0f, #1a1a1a, #0f0f0f); /* Deeper dark gradient */
      background-size: 200% 200%;
      animation: gradient-animation 15s ease infinite;
      color: #e2e8f0; /* Light gray text */
    }
    @keyframes gradient-animation {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
    }
    .loader {
      border: 4px solid rgba(255, 255, 255, 0.2);
      border-top: 4px solid #6366f1; /* Indigo */
      border-radius: 50%;
      width: 24px;
      height: 24px;
      animation: spin 1s linear infinite;
      display: none;
    }
    @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
    }
    </style>
  </head>
  <body class="min-h-screen flex items-center justify-center">
    <div class="flex flex-col gap-6 w-full max-w-lg mx-auto p-8 rounded-xl shadow-lg bg-zinc-900 bg-opacity-80 backdrop-blur-md border border-zinc-700">
      <h1 class="text-2xl font-semibold text-indigo-400 mb-2 text-center">Clip Your Video</h1>
      <input type="text" id="clipVideoUrlInput" placeholder="Enter video URL" class="border border-zinc-700 bg-zinc-800 text-zinc-100 rounded-md px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-500 placeholder-zinc-400" />
      <div class="flex flex-col sm:flex-row gap-3 w-full">
        <input type="text" id="startTimeInput" placeholder="Start time (e.g. 00:01:23)" class="flex-1 w-full border border-zinc-700 bg-zinc-800 text-zinc-100 rounded-md px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-500 placeholder-zinc-400" />
        <input type="text" id="endTimeInput" placeholder="End time (e.g. 00:02:34)" class="flex-1 w-full border border-zinc-700 bg-zinc-800 text-zinc-100 rounded-md px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-500 placeholder-zinc-400" />
      </div>
      <button id="previewClipBtn" class="bg-indigo-600 text-white rounded-md px-4 py-2.5 hover:bg-indigo-700 transition duration-300 ease-in-out flex items-center justify-center gap-2 shadow-md">
        Preview Clip
        <div id="clipLoader" class="loader"></div>
      </button>
      <div id="previewContainer" class="w-full h-64 bg-zinc-800 rounded-md flex items-center justify-center text-zinc-400 mt-4 overflow-hidden border border-zinc-700">
        <span>Preview will appear here</span>
      </div>
      <p id="message" class="text-center text-sm text-zinc-300 mt-2"></p>
      <a href="index.html" class="bg-zinc-700 text-white rounded-md px-4 py-2.5 text-center hover:bg-zinc-800 transition duration-300 ease-in-out mt-2 shadow-md">Back to Main</a>
    </div>

    <script>
    const backendUrl = 'http://127.0.0.1:5000';

    async function handleClipPreview() {
    const videoUrl = document.getElementById('clipVideoUrlInput').value;
    const startTime = document.getElementById('startTimeInput').value;
    const endTime = document.getElementById('endTimeInput').value;
    const messageElement = document.getElementById('message');
    const previewContainer = document.getElementById('previewContainer');
    const previewClipBtn = document.getElementById('previewClipBtn');
    const clipLoader = document.getElementById('clipLoader');

    messageElement.textContent = '';
    messageElement.style.color = '';
    previewContainer.innerHTML = '<span class="text-zinc-400">Loading preview...</span>';
    previewClipBtn.disabled = true;
    clipLoader.style.display = 'block';

    if (!videoUrl || !startTime || !endTime) {
    messageElement.textContent = 'Please enter video URL, start time, and end time.';
    messageElement.style.color = '#ef4444';
    previewContainer.innerHTML = '<span class="text-zinc-400">Preview will appear here</span>';
    previewClipBtn.disabled = false;
    clipLoader.style.display = 'none';
    return;
    }

    try {
    const response = await fetch(`${backendUrl}/clip_video`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
    video_url: videoUrl,
    start_time: startTime,
    end_time: endTime
    })
    });

    const data = await response.json();

    if (!response.ok) {
    throw new Error(data.error || 'Failed to clip video.');
    }

    messageElement.textContent = 'Video clipped successfully! Loading preview...';
    messageElement.style.color = '#22c55e';

    const videoElement = document.createElement('video');
    videoElement.controls = true;
    videoElement.autoplay = true;
    videoElement.src = `${backendUrl}${data.download_link}`;
    videoElement.className = 'w-full h-full object-contain rounded-md';

    previewContainer.innerHTML = '';
    previewContainer.appendChild(videoElement);

    } catch (error) {
    console.error('Clipping Error:', error);
    messageElement.textContent = `Error: ${error.message}`;
    messageElement.style.color = '#ef4444';
    previewContainer.innerHTML = '<span class="text-zinc-400">Preview will appear here</span>';
    } finally {
    previewClipBtn.disabled = false;
    clipLoader.style.display = 'none';
    }
    }

    document.getElementById('previewClipBtn').onclick = handleClipPreview;
    </script>
  </body>
</html>

